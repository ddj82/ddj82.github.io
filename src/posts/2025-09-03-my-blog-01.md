---
layout: post
title: "React + Konva로 테트리스 게임 만들기"
date: 2025-09-03
categories: ["React", "Konva"]
---

안녕하세요 ddj82입니다.  
이번 글에서는 **React + Konva**를 활용해 블로그의 오락실 탭에 구현한 **테트리스 게임** 제작 과정을 정리해보겠습니다.

---

## 프로젝트 개요

React 환경에서 2D 캔버스 기반 UI를 쉽게 다룰 수 있는 **react-konva**를 사용하여 테트리스를 구현했습니다.  
또한 **lucide-react 아이콘**을 활용해 조작 버튼과 키보드 가이드를 함께 구성했습니다.

---

## 보드와 블록 설정

### 보드 구성

- 10열 × 20행으로 테트리스 기본 규격을 따릅니다.  
- 각 칸(Cell)은 숫자로 표현되며 `0`은 빈칸, `1~7`은 블록 색상을 의미합니다.

### 테트로미노 정의

```ts
const TETROS: Record<number, Cell[][][]> = {
    1: [ // ㅣ
        [[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],
        [[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],
        [[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],
        [[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],
    ],
    2: [ // ㅁ
        [[2,2],[2,2]], [[2,2],[2,2]], [[2,2],[2,2]], [[2,2],[2,2]],
    ],
    3: [ // ㅜ
        [[0,3,0],[3,3,3],[0,0,0]],
        [[0,3,0],[0,3,3],[0,3,0]],
        [[0,0,0],[3,3,3],[0,3,0]],
        [[0,3,0],[3,3,0],[0,3,0]],
    ],
    4: [ // J
        [[4,0,0],[4,4,4],[0,0,0]],
        [[0,4,4],[0,4,0],[0,4,0]],
        [[0,0,0],[4,4,4],[0,0,4]],
        [[0,4,0],[0,4,0],[4,4,0]],
    ],
    5: [ // L
        [[0,0,5],[5,5,5],[0,0,0]],
        [[0,5,0],[0,5,0],[0,5,5]],
        [[0,0,0],[5,5,5],[5,0,0]],
        [[5,5,0],[0,5,0],[0,5,0]],
    ],
    6: [ // S
        [[0,6,6],[6,6,0],[0,0,0]],
        [[0,6,0],[0,6,6],[0,0,6]],
        [[0,0,0],[0,6,6],[6,6,0]],
        [[6,0,0],[6,6,0],[0,6,0]],
    ],
    7: [ // Z
        [[7,7,0],[0,7,7],[0,0,0]],
        [[0,0,7],[0,7,7],[0,7,0]],
        [[0,0,0],[7,7,0],[0,7,7]],
        [[0,7,0],[7,7,0],[7,0,0]],
    ],
};

const COLORS: Record<Cell, string> = {
    0: "transparent",
    1: "#3bc7ff",
    2: "#ffd166",
    3: "#c084fc",
    4: "#60a5fa",
    5: "#f97316",
    6: "#22c55e",
    7: "#ef4444",
};
```
각 블록은 **회전 상태 4개**를 미리 정의하여 회전 시 쉽게 참조할 수 있도록 했습니다.

---

## 핵심 로직

### 충돌 감지
- 블록이 보드 경계나 다른 블록과 겹치는지 검사합니다.  
- 겹치면 이동/회전을 무효화하여 게임 규칙을 지킵니다.

### 라인 클리어
- 한 줄이 가득 차면 해당 줄을 제거하고 위의 블록을 내려줍니다.  
- 클리어한 줄 수에 따라 점수가 달라집니다.  
  (`1줄=100점`, `2줄=300점`, `3줄=500점`, `4줄=800점`)

### 게임 오버 처리
- 새 블록이 스폰될 때 이미 충돌하거나,  
- 블록이 위쪽(보드 영역 밖)까지 차오르면 **GAME OVER**를 표시합니다.

---

## 입력과 조작

### 키보드 조작
- `← →` : 좌우 이동  
- `↓` : 소프트 드랍  
- `↑ / Space` : 회전  
- `Enter` : 시작 / 재시작  

### 모바일 터치 조작
- **스와이프** : 좌우/하강 이동  
- **탭** : 회전  
- **탭(게임 전/종료 후)** : 시작 및 재시작  

화면 하단에는 **모바일 전용 가상 버튼**도 배치했습니다.

---

## UI 구현

- **react-konva**로 격자(Grid)와 블록을 그렸습니다.  
- 블록에는 `cornerRadius + shadow`를 적용해 입체감을 주었습니다.  
- 시작 전/게임 오버 시에는 **반투명 오버레이**와 안내 메시지를 표시했습니다.

---

## 결과

완성된 테트리스는 다음과 같은 특징을 가집니다:

- PC/모바일 모두 조작 가능  
- 점수 표시 및 라인 클리어 반영  
- 게임 오버 및 재시작 지원  

블로그 오락실 탭에서 실제로 플레이할 수 있습니다.

---

## 마무리하며

React와 Konva를 조합하면 복잡한 캔버스 렌더링도 간단하게 처리할 수 있습니다.  
블로그 글만 보는 건 조금 밋밋할 수 있어서, 오락실 탭에 재미있는 요소들을 추가해봤습니다.  
현재는 테트리스 외에도 **오늘의 운세 뽑기** 같은 가벼운 즐길거리도 준비되어 있습니다. 

단순한 블로그가 아니라 방문할 때마다 즐길 수 있는 공간으로 만들어가겠습니다. 🎮

감사합니다.